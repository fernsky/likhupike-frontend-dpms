<ng-template #overflowMenuItemTemplate let-data="data">
  <cds-overflow-menu>
    <cds-overflow-menu-option> First Option </cds-overflow-menu-option>
    <cds-overflow-menu-option> Second Option </cds-overflow-menu-option>
    <cds-overflow-menu-option> Third Option </cds-overflow-menu-option>
  </cds-overflow-menu>
</ng-template>

<ng-template #paginationTableItemTemplate let-data="data">
  <a [attr.href]="data.link">{{ data.name }} {{ data.surname }}</a>
</ng-template>
<ng-template #filterableHeaderTemplate let-data="data">
  <i
    ><a [attr.href]="data.link">{{ data.name }}</a></i
  >
</ng-template>

<cds-table-container>
  <cds-table-header>
    <h4 cdsTableHeaderTitle>User Management</h4>
    <p cdsTableHeaderDescription>
      Manage users, their permissions, and approval status
    </p>
  </cds-table-header>

  <cds-table-toolbar>
    <cds-table-toolbar-content>
      <cds-table-toolbar-search
        [expandable]="true"
        (valueChange)="filterUsers($event)"
        (clear)="filterUsers('')"
      >
      </cds-table-toolbar-search>

      <button
        cdsButton="ghost"
        class="toolbar-action"
        [cdsOverflowMenu]="filterTemplate"
        placement="bottom"
        [flip]="true"
      >
        <svg
          cdsIcon="settings"
          size="16"
          class="cds--toolbar-action__icon"
        ></svg>
      </button>

      <button cdsButton="primary" size="sm" (click)="onCreateUser()">
        Add User
        <svg cdsIcon="add" size="20" class="cds--btn__icon"></svg>
      </button>
    </cds-table-toolbar-content>
  </cds-table-toolbar>

  <cds-table
    [model]="model"
    [size]="size"
    [skeleton]="skeleton"
    [sortable]="true"
    [stickyHeader]="true"
    [striped]="true"
  >
  </cds-table>

  <cds-pagination
    [model]="model"
    (selectPage)="selectPage($event)"
    [pageInputDisabled]="false"
  >
  </cds-pagination>
</cds-table-container>

<!-- Templates -->
<ng-template #filterTemplate>
  <div style="padding: 1rem" (click)="$event.stopPropagation()">
    <div style="padding-bottom: 1rem; color: grey">Filter Options</div>
    <cds-checkbox (checkedChange)="toggleApprovalFilter($event)">
      Show only approved users
    </cds-checkbox>
  </div>
</ng-template>

<ng-template #statusTemplate let-data="data">
  <span [class]="data === 'Approved' ? 'approved-status' : 'pending-status'">
    {{ data }}
  </span>
</ng-template>

<ng-template #actionTemplate let-data="data">
  <div class="action-buttons">
    <button cdsButton="ghost" size="sm" (click)="onEditUser(data.id)">
      <svg cdsIcon="edit" size="16"></svg>
    </button>
    <button cdsButton="ghost" size="sm" (click)="onDeleteUser(data.id)">
      <svg cdsIcon="trash-can" size="16"></svg>
    </button>
  </div>
</ng-template>

<style>
  .approved-status {
    color: #24a148;
    font-weight: 500;
  }

  .pending-status {
    color: #f1c21b;
    font-weight: 500;
  }

  .action-buttons {
    display: flex;
    gap: 0.5rem;
  }
</style>
