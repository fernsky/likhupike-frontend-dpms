<div class="user-list-container">
  <app-breadcrumb></app-breadcrumb>

  <app-page-title
    titleTranslationKey="user.list.title"
    descriptionTranslationKey="user.list.subtitle"
    icon="manage_accounts"
  >
    <ng-template #actions>
      <button mat-raised-button class="create-button" (click)="onCreateUser()">
        <mat-icon>add</mat-icon>
        {{ "user.list.createButton" | transloco }}
      </button>
    </ng-template>
  </app-page-title>

  <!-- Search and Actions -->
  <div class="search-and-filter-bar">
    <div class="actions-bar">
      <app-user-search
        [initialValue]="searchControl.value ?? ''"
        (searchChange)="onSearch($event)"
      ></app-user-search>

      <button
        mat-stroked-button
        class="filter-button"
        [class.active]="showFilters"
        (click)="toggleFilters()"
      >
        <mat-icon>filter_list</mat-icon>
        {{
          (showFilters
            ? "user.list.search.hideFilters"
            : "user.list.search.showFilters"
          ) | transloco
        }}
      </button>
    </div>

    <!-- Update filters section -->
    <app-user-filters
      [show]="showFilters"
      [filterForm]="filterForm"
      (filtersChange)="onFiltersChange($event)"
    ></app-user-filters>
  </div>

  <app-users-table
    [dataSource]="dataSource"
    [loading]="(loading$ | async) ?? false"
    [totalUsers]="(totalUsers$ | async) ?? 0"
    (edit)="onEditUser($event)"
    (delete)="onDeleteUser($event)"
    (toggleStatus)="onToggleStatus($event)"
    (pageChange)="loadUsers()"
  ></app-users-table>
</div>
