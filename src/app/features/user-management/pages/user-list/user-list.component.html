<cds-table-container>
  <cds-table-header>
    <h4 cdsTableHeaderTitle>User Management</h4>
    <p cdsTableHeaderDescription>
      Manage users, their permissions, and approval status
    </p>
  </cds-table-header>

  <cds-table-toolbar>
    <cds-table-toolbar-content>
      <cds-table-toolbar-search
        [expandable]="true"
        [value]="searchTerm"
        (valueChange)="filterUsers($event)"
        (clear)="filterUsers('')"
      >
      </cds-table-toolbar-search>

      <button
        cdsButton="ghost"
        class="toolbar-action"
        [cdsOverflowMenu]="filterTemplate"
        placement="bottom"
        [flip]="true"
      >
        <svg
          cdsIcon="settings"
          size="16"
          class="cds--toolbar-action__icon"
        ></svg>
      </button>

      <button cdsButton="primary" size="sm" (click)="onCreateUser()">
        Add User
        <svg cdsIcon="add" size="20" class="cds--btn__icon"></svg>
      </button>
    </cds-table-toolbar-content>
  </cds-table-toolbar>

  <div class="table-container">
    <cds-table
      [model]="model"
      [size]="size"
      [skeleton]="skeleton"
      [sortable]="true"
      [striped]="false"
      [stickyHeader]="true"
      (sort)="sortTable($event)"
    >
    </cds-table>
  </div>

  <cds-pagination
    *ngIf="model.totalDataLength > 0"
    [model]="model"
    (selectPage)="selectPage($event)"
    [disabled]="skeleton"
    [pageInputDisabled]="false"
  >
  </cds-pagination>
</cds-table-container>

<!-- Templates -->
<ng-template #filterTemplate>
  <div style="padding: 1rem" (click)="$event.stopPropagation()">
    <cds-checkbox
      [checked]="showOnlyPending"
      (checkedChange)="toggleApprovalFilter($event)"
    >
      Pending Users
    </cds-checkbox>
  </div>
</ng-template>

<ng-template #statusTemplate let-data="data">
  <div
    [ngClass]="{
      'status-approved': data === 'Approved',
      'status-pending': data === 'Pending',
    }"
  >
    {{ data }}
  </div>
</ng-template>

<ng-template #actionTemplate let-data="data">
  <div class="action-buttons">
    <cds-overflow-menu>
      <cds-overflow-menu-option (click)="onEditUser(data.id)">
        <div class="overflow-option">
          <svg cdsIcon="settings" size="16"></svg> Edit
        </div>
      </cds-overflow-menu-option>
      <cds-overflow-menu-option (click)="onDeleteUser(data.id)">
        <div class="overflow-option">
          <svg cdsIcon="trash-can" size="16"></svg> Delete
        </div>
      </cds-overflow-menu-option>
    </cds-overflow-menu>
  </div>
</ng-template>

<ng-template #paginationTableItemTemplate let-data="data">
  <a [attr.href]="data.link">{{ data.name }} {{ data.surname }}</a>
</ng-template>
<ng-template #filterableHeaderTemplate let-data="data">
  <i
    ><a [attr.href]="data.link">{{ data.name }}</a></i
  >
</ng-template>
