@use "@carbon/styles/scss/spacing" as *;
@use "@carbon/styles/scss/type" as *;
@use "@carbon/styles/scss/theme" as *;
@use "@carbon/styles/scss/breakpoint" as *;
@use "@carbon/styles/scss/motion" as *;
@use "@carbon/styles/scss/config" as *;
@use "@carbon/styles/scss/components/pagination";
@use "@carbon/styles/scss/components/data-table";
@use "@carbon/styles/scss/components/tag";
@use "@carbon/styles/scss/components/button";
@use "@carbon/styles/scss/components/dropdown";
@use "@carbon/styles/scss/components/form";

// Define the Carbon standard easing curve
$carbon--standard-easing: cubic-bezier(0.2, 0, 0.38, 0.9);
$tag-background-01: #e0e0e0;
$tag-hover-01: #c6c6c6;
$tag-text-01: #393939;
$support-01: #da1e28;
$hover-row: #e8e8e8;

:host {
  --text-01: var(--cds-text-01, #161616);
  --text-02: var(--cds-text-02, #525252);
  --icon-01: var(--cds-icon-01, #161616);
  --icon-02: var(--cds-icon-02, #525252);
  --layer-01: var(--cds-layer-01, #f4f4f4);
  --layer-02: var(--cds-layer-02, #ffffff);
  --layer-hover: var(--cds-layer-hover, #e8e8e8);
  --layer-accent: var(--cds-layer-accent, #f4f4f4);
  --border-subtle-01: var(--cds-border-subtle-01, #e0e0e0);
  --border-subtle-selected-01: var(--cds-border-subtle-selected-01, #c6c6c6);
  --border-interactive: var(--cds-border-interactive, #0f62fe);
  --button-primary: var(--cds-button-primary, #0f62fe);
  --button-primary-hover: var(--cds-button-primary-hover, #0353e9);
  --support-error: var(--cds-support-error, #da1e28);
  --support-success: var(--cds-support-success, #24a148);
  --support-warning: var(--cds-support-warning, #f1c21b);
  --tag-background-gray: var(--cds-tag-background-gray, #e0e0e0);
  --tag-hover-gray: var(--cds-tag-hover-gray, #c6c6c6);
  --tag-color-gray: var(--cds-tag-color-gray, #393939);
}

.cds--user-list-container {
  padding: $spacing-05;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  animation: fadeIn 0.3s $carbon--standard-easing;

  .cds--page-header {
    padding-bottom: $spacing-07;

    &__container {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-start;

      @include breakpoint-down("md") {
        flex-direction: column;
        gap: $spacing-05;
      }
    }

    &__title-container {
      max-width: 75%;

      @include breakpoint-down("md") {
        max-width: 100%;
      }
    }

    &__title {
      @include type-style("productive-heading-04");
      color: var(--text-01);
      margin-bottom: $spacing-03;
    }

    &__subtitle {
      @include type-style("body-long-01");
      color: var(--text-02);
    }

    &__actions {
      display: flex;
      align-items: center;
      justify-content: flex-end;

      @include breakpoint-down("md") {
        width: 100%;
      }
    }
  }

  .cds--add-user-button {
    display: flex;
    align-items: center;
    gap: $spacing-03;

    svg {
      margin-right: $spacing-03;
    }
  }

  .cds--table-container {
    background-color: var(--layer-01);
    width: 100%;
    position: relative;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
    border-radius: $spacing-01;
    overflow: hidden;

    .cds--data-table-loading {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;

      .cds--loading-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(255, 255, 255, 0.7);
      }
    }

    .cds--data-table-empty,
    .cds--data-table-error {
      padding: $spacing-09 $spacing-05;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 300px;

      .cds--empty-state {
        text-align: center;
        max-width: 450px;

        &__icon {
          display: flex;
          justify-content: center;
          margin-bottom: $spacing-05;

          svg {
            fill: var(--icon-01);
          }
        }

        &__title {
          @include type-style("productive-heading-03");
          margin-bottom: $spacing-03;
          color: var(--text-01);
        }

        &__text {
          @include type-style("body-long-01");
          margin-bottom: $spacing-06;
          color: var(--text-02);
        }

        &--error {
          .cds--empty-state__icon svg {
            fill: $support-01;
          }
        }
      }
    }
  }

  .cds--table-toolbar {
    padding: $spacing-05;
    display: flex;
    flex-direction: column;
    width: 100%;
    border-bottom: 1px solid var(--border-subtle-01);

    .cds--toolbar-content {
      display: flex;
      justify-content: space-between;
      width: 100%;

      @include breakpoint-down("md") {
        flex-direction: column;
        gap: $spacing-05;
      }

      .cds--toolbar-search-container {
        flex: 1;
        max-width: 550px;

        @include breakpoint-down("md") {
          width: 100%;
          max-width: 100%;
        }
      }

      .cds--toolbar-action-buttons {
        display: flex;
        align-items: center;
        gap: $spacing-03;

        .cds--toolbar-action {
          display: flex;
          align-items: center;
          gap: $spacing-03;
        }
      }
    }

    .cds--table-toolbar-filter-panel {
      margin-top: $spacing-05;
      padding-top: $spacing-05;
      border-top: 1px solid var(--border-subtle-01);

      .cds--form-field-row {
        margin-bottom: $spacing-05;
      }

      .cds--permission-checks {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: $spacing-03 $spacing-05;
        margin-top: $spacing-03;
      }

      .cds--filter-actions {
        display: flex;
        justify-content: flex-end;
        gap: $spacing-03;
        margin-top: $spacing-05;
      }
    }
  }

  cds-table {
    ::ng-deep {
      .cds--data-table {
        .cds--tag-wrapper {
          display: flex;
          flex-wrap: wrap;
          gap: $spacing-02;

          .cds--tag {
            height: 24px;
            min-width: auto;
            max-width: 100%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 0.75rem;

            &.cds--tag-more {
              background-color: $tag-background-01;
              color: $tag-text-01;
              cursor: pointer;

              &:hover {
                background-color: $tag-hover-01;
              }
            }
          }
        }

        .cds--data-table tbody tr:hover td {
          background-color: $hover-row;
          color: var(--text-01);
        }

        .cds--overflow-menu-wrapper {
          display: flex;
          justify-content: center;
        }
      }
    }
  }

  .cds--pagination-container {
    border-top: 1px solid var(--border-subtle-01);

    cds-pagination {
      width: 100%;
    }
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@include breakpoint-down("md") {
  .cds--user-list-container {
    padding: $spacing-04;

    .cds--table-toolbar {
      padding: $spacing-04;
    }
  }
}

@include breakpoint-down("sm") {
  .cds--user-list-container {
    padding: $spacing-03;

    .cds--add-user-button {
      width: 100%;
      justify-content: center;
    }

    .cds--table-toolbar {
      padding: $spacing-03;

      .cds--table-toolbar-filter-panel {
        .cds--permission-checks {
          grid-template-columns: 1fr;
        }
      }
    }
  }
}

@media print {
  .cds--user-list-container {
    .cds--table-toolbar,
    .cds--pagination-container,
    .cds--page-header__actions {
      display: none;
    }

    .cds--table-container {
      box-shadow: none;
      border: none;
    }

    ::ng-deep {
      .cds--data-table {
        thead,
        tbody,
        tr,
        th,
        td {
          page-break-inside: avoid;
        }
      }
    }
  }
}
