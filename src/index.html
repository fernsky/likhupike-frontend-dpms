<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Digital Profile Information System</title>
    <base href="/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="favicon.ico" />

    <!-- Preconnect to Google Fonts for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Material icons -->
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Icons+Outlined"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Icons"
      rel="stylesheet"
    />

    <!-- Fonts for our application - preloaded -->
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&family=Noto+Sans+Devanagari:wght@400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Optimized language detection and font application script -->
    <script>
      // Execute immediately - as early as possible
      (function () {
        try {
          const savedLang = localStorage.getItem("selected_language") || "en";
          const htmlEl = document.documentElement;

          // Set lang attribute
          htmlEl.setAttribute("lang", savedLang);

          // Add language class
          htmlEl.classList.add(`lang-${savedLang}`);

          // Set font directly - this is faster than relying on CSS
          if (savedLang === "ne") {
            htmlEl.style.fontFamily = '"Noto Sans Devanagari", sans-serif';
          } else {
            htmlEl.style.fontFamily = '"IBM Plex Sans", sans-serif';
          }

          // Add storage event listener for cross-tab sync
          window.addEventListener("storage", function (e) {
            if (e.key === "selected_language") {
              const newLang = e.newValue || "en";

              // Update lang attribute
              htmlEl.setAttribute("lang", newLang);

              // Remove all lang classes and add the new one
              htmlEl.classList.remove("lang-en", "lang-ne");
              htmlEl.classList.add(`lang-${newLang}`);

              // Update font
              if (newLang === "ne") {
                htmlEl.style.fontFamily = '"Noto Sans Devanagari", sans-serif';
              } else {
                htmlEl.style.fontFamily = '"IBM Plex Sans", sans-serif';
              }
            }
          });
        } catch (e) {
          // Silent fail - default styles will apply
        }
      })();
    </script>

    <!-- Critical CSS for language-specific fonts -->
    <style>
      body {
        margin: 0;
        font-family: inherit;
      }

      /* These classes are applied early by the script above */
      html.lang-en {
        font-family: "IBM Plex Sans", sans-serif;
      }

      html.lang-ne {
        font-family: "Noto Sans Devanagari", sans-serif;
      }
    </style>
  </head>
  <body>
    <app-root></app-root>
  </body>
</html>
